{% extends 'solution/base.html' %}
{% block solution_content %}
    <div class="row">
        <div class="span2">
            <ul class="nav nav-list well">
                <li class="nav-header">repositories</li>
                {% for project_repository in repositories %}
                    <li{% if project_repository.id == repository.id %} class="active"{% endif %}><a href="{% url 'project:solution:commits' project.name solution.id project_repository.name %}">{{ project_repository.name }}</a></li>
                {% endfor %}
            </ul>
        </div>
        <div class="span10">
            <h4>{{ repository.full_name }}</h4>
            <h5>Commits</h5>
            {% for commit in commits %}
                <p>
                    {{ commit.message }} by {{ commit.author.name }}<br/>
                    <span class="muted">{{ commit.hex }}</span>
                </p>
            {% empty %}
                <p class="muted">No commits on this repo for this particular solution.</p>
            {% endfor %}
            <h5>Difference</h5>
            {% for patch in diff %}
                <p><i class="icon-file"></i> {{ patch.new_file_path }} <span class="muted">({{ patch.old_file_path }})</span></p>
                {% for hunk in patch.hunks %}
                    <p>
                        <strong>old</strong> : start : {{ hunk.old_start }} : lines : {{ hunk.old_lines }} ~ 
                        <strong>new</strong> : start : {{ hunk.new_start }} : lines : {{ hunk.new_lines }}
                    </p>
                    <table class="table table-bordered table-hover table-condensed">
                        {% for act, line in hunk.lines %}
                            <tr>
                                <td style="text-align: center; width: 30px;">
                                    {% if forloop.counter0 < hunk.old_lines %}
                                        {{ forloop.counter0|add:hunk.old_start }}
                                    {% endif %}
                                </td>
                                <td style="text-align: center; width: 30px;">{{ forloop.counter0|add:hunk.new_start }}</td>
                                <td style="text-align: center; width: 30px;">{{ act }}</td>
                                <td>{{ line }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="2" class="muted">No lines for this hunk.</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% empty %}
                    <p class="muted">No hunks for this patch.</p>
                {% endfor %}
            {% empty %}
                <p class="muted">No patches on this repo for this particular solution.</p>
            {% endfor %}
        </div>
    </div>
{% endblock %}