{% extends 'solution/base.html' %}
{% block solution_content %}
    <div class="row">
        <div class="span2">
            <ul class="nav nav-list well">
                <li class="nav-header">repositories</li>
                {% for project_repository in repositories %}
                    <li{% if project_repository.id == repository.id %} class="active"{% endif %}><a href="{% url 'project:solution:commits' project.name solution.id project_repository.name %}">{{ project_repository.name }}</a></li>
                {% endfor %}
            </ul>
        </div>
        <div class="span10">
            <h4>{{ repository.full_name }}</h4>
            {% for commit in commits %}
                <div class="row">
                    <div class="span1 text-center">
                        <strong>{{ commit.author }}</strong>
                    </div>
                    <div class="span9">
                        <p>
                            <small class="muted">{{ commit.time_committed|date }} @ {{ commit.time_committed|time }}</small><br/>
                            {{ commit.message }}<br/>
                            <small class="text-info">{{ commit.hex }}</small>
                        </p>
                    </div>
                </div>
            {% empty %}
                <p class="muted">No commits on this repo for this particular solution.</p>
            {% endfor %}
            <h5>Difference</h5>
            {% for patch in diff %}
                <p><i class="icon-file"></i> {{ patch.new_file_path }} <span class="muted">({{ patch.old_file_path }})</span></p>
                {% for hunk in patch %}
                    <p>
                        <strong>old</strong> : start : {{ hunk.old_start }} : lines : {{ hunk.old_line_count }} ~
                        <strong>new</strong> : start : {{ hunk.new_start }} : lines : {{ hunk.new_line_count }}
                    </p>
                    <table class="table table-bordered table-hover table-condensed">
                        {% for line in hunk %}
                            <tr class="{% if line.is_addition %}success{% elif line.is_deletion %}error{% endif %}">
                                <td style="text-align: center; width: 30px;">
                                    {% if line.old_line_number %}
                                        {{ line.old_line_number }}
                                    {% endif %}
                                </td>
                                <td style="text-align: center; width: 30px;">
                                    {% if line.new_line_number %}
                                        {{ line.new_line_number }}
                                    {% endif %}
                                </td>
                                <td style="white-space: pre-wrap;">{{ line.line }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="2" class="muted">No lines for this hunk.</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% empty %}
                    <p class="muted">No hunks for this patch.</p>
                {% endfor %}
            {% empty %}
                <p class="muted">No patches on this repo for this particular solution.</p>
            {% endfor %}
        </div>
    </div>
{% endblock %}